<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>R: Creates 2-dimensional contingency tables - potentially...</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link rel="stylesheet" type="text/css" href="../../assets/R.css">
</head><body>

<table width="100%" summary="page for ds.table2d {dsbaseclient}"><tr><td>ds.table2d {dsbaseclient}</td><td align="right">R Documentation</td></tr></table>

<h2>Creates 2-dimensional contingency tables - potentially disclosive data are suppressed</h2>

<h3>Description</h3>

<p>The function ds.table2d is a client-side wrapper
function. It calls the server-side subfunction table2d.ds
to generate 2-dimensional tables for all data sources.
Valid (non-disclosive) data are defined as data from
sources where no table cells have counts between 1 and 4
(the upper value [4] can in principle be changed but only
by rewriting the underlying function - it cannot be
changed by a standard DataSHIELD user). If the count in
any cell in the table produced by a given data source IS
invalid, that cell count is changed to &quot;-1&quot; and the name
of the two categories that correspond to it are both
changed to &quot;-9&quot;. Each source is flagged as having only
valid data, or at least some invalid data. The function
ds.table2d prints out counts, column percents, row
percents, global percents and a chi-squared test for
homogeneity on (nc-1)*(nr-1) degrees of freedom where nc
is the number of columns and nr is the number of rows.
These calaculations are done separately for each source
and, in addition, all valid sources are combined to
produce a single overarching contingency for all valid
data collectively. Missing data are treated as
na.action=na.omit (default for table function), if
missing data are to be treated as a separate and visible
category, the variable should first be transformed to
convert NAs to the a new value.
</p>


<h3>Usage</h3>

<pre>
  ds.table2d(datasources = NULL, xvect = NULL,
    yvect = NULL, type = "combine")
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>datasources</code></td>
<td>
<p>a list of opal object(s) obtained
after login in to opal servers; these objects hold also
the data assign to R, as <code>dataframe</code>, from opal
datasources.</p>
</td></tr>
<tr valign="top"><td><code>xvect</code></td>
<td>
<p>a numerical vector with discrete values -
usually a factor</p>
</td></tr>
<tr valign="top"><td><code>yvect</code></td>
<td>
<p>a numerical vector with discrete values -
usually a factor</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>a character which represent the type of graph
to display If <code>type</code> is set to 'combine', a
histogram that merges the single plot is displayed. Each
histogram is plotted separately if If <code>type</code> is set
to 'split'.</p>
</td></tr>
</table>


<h3>Value</h3>

<p>A list object containing the following items (depending
on the type of analysis specified -'combined' or 'split-
some of these items may not be returned):
</p>
<table summary="R valueblock">
<tr valign="top"><td><code>OPALS.DATA.OVERVIEW</code></td>
<td>
<p>For each study contains
$study.name (ie name of study), $is.table.valid (TRUE if
all cells valid otherwise FALSE), $safe.table (the safe
contingency table that contains all cells if all are
valid, but otherwise obscures invalid cells by outputting
a cell count of &quot;-1&quot; and making the two category
indicators for that cell = &quot;-9&quot;. In other words
OPALS.DATA.OVERVIEW provides the information generated by
the server side subfunction table2d.ds on its own.</p>
</td></tr>
<tr valign="top"><td><code>ALL.VALID.TABLES.BY.STUDY</code></td>
<td>
<p>Counts, column percents,
row percents and global percents for each study
separately (if separate.and.combined.studies=TRUE) and
for all valid studies combined</p>
</td></tr>
<tr valign="top"><td><code>CHI2.TESTS.FOR.HOMOGENEITY</code></td>
<td>
<p>Chi-squared test for
homogeneity, for each study separately (if
separate.and.combined.studies=TRUE) and for all valid
studies combined</p>
</td></tr> <tr valign="top"><td><code>VALIDITY.WARNING - IF
NEEDED</code></td>
<td>
<p>Either reports that all studies are valid, or
else lists the studies that contain at least one cell
that is invalid, or else reports &quot;NO STUDIES HAVE VALID
DATA - SO NO ATTEMPT TO COMBINE&quot;</p>
</td></tr>
<tr valign="top"><td><code>TABLES.VALID.DATA.COUNTS</code></td>
<td>
<p>If
all.output.configurations=TRUE, cell counts, for each
study separately and for all valid studies combined</p>
</td></tr>
<tr valign="top"><td><code>TABLES.VALID.DATA.COLUMN.PERCENTS</code></td>
<td>
<p>If
all.output.configurations=TRUE, column percents, for each
study separately and for all valid studies combined</p>
</td></tr>
<tr valign="top"><td><code>TABLES.VALID.DATA.ROW.PERCENTS</code></td>
<td>
<p>If
all.output.configurations=TRUE, row percents, for each
study separately and for all valid studies combined</p>
</td></tr>
<tr valign="top"><td><code>TABLES.VALID.DATA.GLOBAL.PERCENTS</code></td>
<td>
<p>If
all.output.configurations=TRUE, global percents, for each
study separately and for all valid studies combined</p>
</td></tr>
</table>


<h3>Author(s)</h3>

<p>Burton P.; Gaye, A.
</p>


<h3>Examples</h3>

<pre>
{
# load the file that contains the login details
data(logindata)

# login and assign the required variables to R
myvar  &lt;-  list("DIS_DIAB", "DIS_CVA", "GENDER", "LAB_HDL")
opals  &lt;-  datashield.login(logins=logindata,assign=TRUE,variables=myvar)

# Example 1: generate a two dimensional table, outputting combined contingency tables - default behaviour
ds.table2d(datasources=opals, quote(D$DIS_DIAB), quote(D$GENDER))

# Example 2: generate a two dimensional table, outputting study specific contingency tables
ds.table2d(datasources=opals, quote(D$DIS_DIAB), quote(D$GENDER), type="split")

# Example 3: generate a two dimensional table, outputting study specific contingency tables for the first two studies
ds.table2d(datasources=opals[1:2], quote(D$DIS_DIAB), quote(D$GENDER), type="split")

# Example 4: generate a two dimensional table, outputting combined contingency tables (in this case some studies are invalid)
ds.table2d(datasources=opals, quote(D$DIS_CVA), quote(D$GENDER))

# Example 5: generate a two dimensional table, outputting study specific contingency tables (in this case some studies are invalid)
ds.table2d(datasources=opals, quote(D$DIS_CVA), quote(D$GENDER), type="split")
# Example 6: generate a two dimensional table, outputting study specific and combined contingency tables, see what happens if
# you try to tabulate a quantitative variable with unique values for many individuals. The standard table() function in R would print out
# all observed "values" as category names in ascending order with a count (generally 1) for each unique number, but ds.table2d prints
# out all values where there are between 1 and 4 observations as -1 and gives the category name -9. It is only when the count is
# 5 or more that the actual value can be observed, and then it is non-disclosive
ds.table2d(datasources=opals, quote(D$GENDER), quote(D$LAB_HDL))
ds.table2d(datasources=opals, quote(D$GENDER), quote(D$LAB_HDL), type="split")
}
</pre>

<hr><div align="center">[Package <em>dsbaseclient</em> version 2.1 ]</div>
</body></html>
