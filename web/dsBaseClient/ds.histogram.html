<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><title>R: Generates a histogram plot</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<link rel="stylesheet" type="text/css" href="../../assets/R.css" />
</head><body>

<table width="100%" summary="page for ds.histogram {dsBaseClient}"><tr><td>ds.histogram {dsBaseClient}</td><td style="text-align: right;">R Documentation</td></tr></table>

<h2>Generates a histogram plot</h2>

<h3>Description</h3>

<p><code>ds.histogram</code> function plots a non-disclosive histogram in the client-side.
</p>


<h3>Usage</h3>

<pre>
ds.histogram(
  x = NULL,
  type = "split",
  num.breaks = 10,
  method = "smallCellsRule",
  k = 3,
  noise = 0.25,
  vertical.axis = "Frequency",
  datasources = NULL
)
</pre>


<h3>Arguments</h3>

<table summary="R argblock">
<tr valign="top"><td><code>x</code></td>
<td>
<p>a character string specifying the name of a numerical vector.</p>
</td></tr>
<tr valign="top"><td><code>type</code></td>
<td>
<p>a character string that represents the type of graph to display.
The <code>type</code> argument can be set as <code>'combine'</code> or <code>'split'</code>. 
Default <code>'split'</code>.
For more information see <strong>Details</strong>.</p>
</td></tr>
<tr valign="top"><td><code>num.breaks</code></td>
<td>
<p>a numeric specifying the number of breaks of the histogram. Default value
is <code>10</code>.</p>
</td></tr>
<tr valign="top"><td><code>method</code></td>
<td>
<p>a character string that defines which histogram will be created.
The <code>method</code> argument can be set as <code>'smallCellsRule'</code>, 
<code>'deterministic'</code> or <code>'probabilistic'</code>. 
Default <code>'smallCellsRule'</code>.  
For more information see <strong>Details</strong>.</p>
</td></tr>
<tr valign="top"><td><code>k</code></td>
<td>
<p>the number of the nearest neighbours for which their centroid is calculated. 
Default <code>k</code> value is <code>3</code>.
For more information see <strong>Details</strong>.</p>
</td></tr>
<tr valign="top"><td><code>noise</code></td>
<td>
<p>the percentage of the initial variance that is used as the variance of the embedded
noise if the argument <code>method</code> is set to <code>'probabilistic'</code>. 
Default <code>noise</code> value is  <code>0.25</code>.
For more information see <strong>Details</strong>.</p>
</td></tr>
<tr valign="top"><td><code>vertical.axis, </code></td>
<td>
<p>a character string that defines what is shown in the vertical axis of the
plot. The <code>vertical.axis</code> argument can be set as <code>'Frequency'</code> or <code>'Density'</code>.
Default <code>'Frequency'</code>. 
For more information see <strong>Details</strong>.</p>
</td></tr>
<tr valign="top"><td><code>datasources</code></td>
<td>
<p>a list of <code>DSConnection-class</code> objects obtained after login. 
If the <code>datasources</code> argument is not specified
the default set of connections will be used: see <code>datashield.connections_default</code>.</p>
</td></tr>
</table>


<h3>Details</h3>

<p><code>ds.histogram</code> function allows the user to plot
distinct histograms (one for each study) or a combined histogram that merges
the single plots.
</p>
<p>In the argument <code>type</code> can be specified two types of graphics to display:
</p>

<ul>
<li><p><code>'combine'</code>: a histogram that merges the single plot is displayed. 
</p>
</li>
<li><p><code>'split'</code>: each histogram is plotted separately.
</p>
</li></ul>

<p>In the argument <code>method</code> can be specified 3 different histograms to be created:
</p>

<ul>
<li><p><code>'smallCellsRule'</code>: the histogram of the actual variable is
created but bins with low counts are removed. 
</p>
</li>
<li><p><code>'deterministic'</code>: the histogram of the scaled centroids of each 
<code>k</code> nearest neighbours of the original variable
where the value of <code>k</code> is set by the user. 
</p>
</li>
<li><p><code>'probabilistic'</code>: the histogram shows the original distribution disturbed 
by the addition of random stochastic noise.
The added noise follows a normal distribution with zero mean and
variance equal to a percentage of the initial variance of the input variable. 
This percentage is specified by the user in the argument <code>noise</code>. 
</p>
</li></ul>

<p>In the <code>k</code> argument the user can choose any value for <code>k</code> equal 
to or greater than the pre-specified threshold
used as a disclosure control for this method and lower than the number of observations
minus the value of this threshold. By default the value of <code>k</code> is set to be equal to 3
(we suggest k to be equal to, or bigger than, 3). Note that the function fails if the user
uses the default value but the study has set a bigger threshold. 
The value of <code>k</code> is used only if the argument 
<code>method</code> is set to <code>'deterministic'</code>. 
Any value of k is ignored if the
argument <code>method</code> is set to <code>'probabilistic'</code> or <code>'smallCellsRule'</code>.
</p>
<p>In the <code>noise</code> argument the percentage of the initial variance 
that is used as the variance of the embedded
noise if the argument <code>method</code> is set to <code>'probabilistic'</code>. 
Any value of noise is ignored if the argument 
<code>method</code> is set to <code>'deterministic'</code> or <code>'smallCellsRule'</code>. 
The user can choose any value for noise equal to or greater 
than the pre-specified threshold <code>'nfilter.noise'</code>.
By default the value of noise is set to be equal to 0.25.
</p>
<p>In the argument  <code>vertical.axis</code> can be specified two types of histograms:
</p>

<ul>
<li><p><code>'Frequency'</code>: the histogram of the frequencies
is returned. 
</p>
</li>
<li><p><code>'Density'</code>: the histogram of the densities
is returned.
</p>
</li></ul>

<p>Server function called: <code>histogramDS2</code>
</p>


<h3>Value</h3>

<p>one or more histogram objects and plots depending on the argument <code>type</code>
</p>


<h3>Author(s)</h3>

<p>DataSHIELD Development Team
</p>


<h3>Examples</h3>

<pre>
## Not run: 

## Version 6, for version 5 see the Wiki
  # Connecting to the Opal servers

  require('DSI')
  require('DSOpal')
  require('dsBaseClient')

  builder &lt;- DSI::newDSLoginBuilder()
  builder$append(server = "study1", 
                 url = "http://192.168.56.100:8080/", 
                 user = "administrator", password = "datashield_test&amp;", 
                 table = "CNSIM.CNSIM1", driver = "OpalDriver")
  builder$append(server = "study2", 
                 url = "http://192.168.56.100:8080/", 
                 user = "administrator", password = "datashield_test&amp;", 
                 table = "CNSIM.CNSIM2", driver = "OpalDriver")
  builder$append(server = "study3",
                 url = "http://192.168.56.100:8080/", 
                 user = "administrator", password = "datashield_test&amp;", 
                 table = "CNSIM.CNSIM3", driver = "OpalDriver")
  logindata &lt;- builder$build()
  
  # Log onto the remote Opal training servers
  connections &lt;- DSI::datashield.login(logins = logindata, assign = TRUE, symbol = "D") 
  
  # Compute the histogram
  # Example 1: generate a histogram for each study separately 
  ds.histogram(x = 'D$PM_BMI_CONTINUOUS',
              type = "split",
              datasources = connections) #all studies are used

  # Example 2: generate a combined histogram with the default small cells counts
               suppression rule
  ds.histogram(x = 'D$PM_BMI_CONTINUOUS',
               method = 'smallCellsRule',
               type = 'combine',
               datasources = connections[1]) #only the first study is used (study1)

  # Example 3: if a variable is of type factor the function returns an error
  ds.histogram(x = 'D$PM_BMI_CATEGORICAL',
               datasources = connections)

  # Example 4: generate a combined histogram with the deterministic method for k=50
  ds.histogram(x = 'D$PM_BMI_CONTINUOUS',
               k = 50, 
               method = 'deterministic',
               type = 'combine',
               datasources = connections[2])#only the second study is used (study2)


  # Example 5: create a histogram and the probability density on the plot
  hist &lt;- ds.histogram(x = 'D$PM_BMI_CONTINUOUS',
                       method = 'probabilistic', type='combine',
                       num.breaks = 30, 
                       vertical.axis = 'Density',
                       datasources = connections)
  lines(hist$mids, hist$density)

  # clear the Datashield R sessions and logout
  datashield.logout(connections)
  
## End(Not run)


</pre>

<hr /><div style="text-align: center;">[Package <em>dsBaseClient</em> version 6.1.0 ]</div>
</body></html>
